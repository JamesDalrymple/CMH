{
    "collab_server" : "",
    "contents" : "# read in all FB files, and move them to archived folder and remove them from\n# downloads folder\n\n# source local helper file ----------------------------------------------------\nsource(file.path(\"~\", \"Github/CMH/FB storage\", \"1_FB_auxillary.R\"))\n# read in all FB files in the download folder ---------------------------------\ndownload_location <- \"C:/Users/dalrymplej/Downloads\"\nmove_location <- \"G:/CSTS Data Analyst Archives/FB_archives\"\n\nd00_list <- list.files(download_location, pattern=\"D00\",\n           full.names = TRUE)\n\nrun_date <- format(Sys.Date(), \"%m_%d_%y\")\n\nfor(i in seq_along(d00_list)) {\n  first_6_rows <- data.table(read.table(\n    d00_list[i],\n    nrows = 6,\n    sep = \",\",\n    header = TRUE,\n    stringsAsFactors = FALSE\n  ))\n\n# ?fread\n# fread(input=d00_list[i], header = TRUE, skip=1)\n\n\n\n\n\n\n  dt_type <- tolower(gsub(\n    x = first_6_rows[Report. == \"Direct/Contracted Services:\",\n                     Funding.Source.Bucket.Report],\n    pattern = \" Services\",\n    fixed = TRUE,\n    replace = \"\"\n  ))\n  dt_date <- unlist(strsplit(x = first_6_rows[Report. == \"Date Range:\",\n                                              Funding.Source.Bucket.Report],\n                             split = \" - \"))\n  dt_date <- format(as.Date(dt_date), \"%m_%d_%y\")\n  new_name <- paste(\"fb\", dt_type, paste(dt_date, collapse = \"_to_\"), \"run\",\n                    run_date)\n  # move file in downloads to archived FB folder\n  file.copy(from=d00_list[i], to=file.path(move_location,\n                                           paste0(new_name, \".csv\")))\n  new_dt <- fread(d00_list[i],\n                  select = keep_cols)\n  setnames(new_dt, old=keep_cols, new=new_cols)\n  saveRDS(object = new_dt, file = file.path(move_location, \"rds\",\n                                            paste0(new_name, \".rds\")))\n  gzip(zipfile = file.path(move_location,\n                          paste0(new_name, \".csv\")),\n      )\n  ??gzip\n\n}",
    "created" : 1445285940880.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3881311230",
    "id" : "C6F412BF",
    "lastKnownWriteTime" : 1445359698,
    "path" : "~/GitHub/CMH/FB storage/2_FB_storage.R",
    "project_path" : "2_FB_storage.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}